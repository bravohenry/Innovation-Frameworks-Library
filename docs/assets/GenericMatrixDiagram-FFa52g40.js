import{r as p,j as s,a5 as I,a6 as C,an as D,a8 as z,a4 as v}from"./index-BPEI-QTe.js";import{B as R}from"./BaseInteractiveLayout-Cx_gBR8d.js";import{s as A,l as M}from"./chunk-Y2AYO5NJ-BHTikWkO.js";const P=[{key:"name",labelZh:"名称",labelEn:"Name",type:"text"},{key:"importance",labelZh:"重要度(1-5)",labelEn:"Importance(1-5)",type:"number"},{key:"satisfaction",labelZh:"满意度(1-5)",labelEn:"Satisfaction(1-5)",type:"number"},{key:"notes",labelZh:"备注",labelEn:"Notes",type:"text"}],V=({lang:a="zh",onExport:d,showExportButtons:k=!0,className:N="",initialColumns:y,title:u,data:x})=>{const[h]=p.useState(y&&y.length?y:P),[m,f]=p.useState(()=>x&&Array.isArray(x)?x.map((e,t)=>({id:`r${t+1}`,values:e})):[{id:"r1",values:{name:a==="zh"?"示例项":"Sample",importance:4,satisfaction:2,notes:""}}]),[o,E]=p.useState(!1);p.useEffect(()=>{},[]);const S=()=>{f(e=>[...e,{id:`r${Date.now()}`,values:{name:"",importance:3,satisfaction:3,notes:""}}])},b=(e,t,n)=>{f(i=>i.map(l=>l.id===e?{...l,values:{...l.values,[t]:n}}:l))},Z=e=>{f(t=>t.filter(n=>n.id!==e))},_=e=>{if(e==="csv"){const t=m.map(n=>{const i={};return h.forEach(l=>{const c=a==="en"?l.labelEn:l.labelZh,r=n.values[l.key];r&&typeof r=="object"&&("zh"in r||"en"in r)?i[c]=r[a]??r.zh??r.en??"":i[c]=r??""}),i});d==null||d("csv",t)}else d==null||d("png",{columns:h,rows:m})},w=s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(z,{size:"sm",variant:"flat",color:"primary",startContent:s.jsx(v,{icon:"lucide:plus"}),onPress:S,children:a==="zh"?"添加行":"Add Row"}),s.jsx(z,{size:"sm",variant:o?"solid":"flat",color:o?"primary":"default",startContent:s.jsx(v,{icon:o?"lucide:check":"lucide:edit-3"}),onPress:()=>E(!o),children:o?a==="zh"?"完成":"Done":a==="zh"?"编辑":"Edit"})]}),j=e=>e&&typeof e=="object"&&("zh"in e||"en"in e)?e[a]??e.zh??e.en??"":String(e??""),g=(e,t)=>{const n=a==="en"?e.optionsEn||[]:e.optionsZh||[],i=j(t),l=n.findIndex(c=>c===i);return l>=0?String(l):""};return s.jsx(R,{title:u?a==="en"?u.en:u.zh:a==="zh"?"矩阵表（可编辑）":"Editable Matrix",titleEn:u?u.en:"Editable Matrix",lang:a,onExport:_,showExportButtons:k,controls:w,className:N,data:{columns:h,rows:m},pathLabels:{chapter:a==="zh"?"第2章":"Chapter 2"},children:s.jsx(I,{children:s.jsx(C,{className:"p-0 overflow-x-auto",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-default-50",children:[h.map(e=>s.jsx("th",{className:"px-4 py-3 text-left text-default-600",children:a==="en"?e.labelEn:e.labelZh},e.key)),s.jsx("th",{className:"px-4 py-3"})]})}),s.jsx("tbody",{children:m.map(e=>s.jsxs("tr",{className:"border-t",children:[h.map(t=>s.jsx("td",{className:"px-4 py-2 align-middle",children:o?t.type==="select"?s.jsx(A,{"aria-label":"select",selectedKeys:[g(t,e.values[t.key])],onSelectionChange:n=>{const i=parseInt(Array.from(n)[0],10),l=(t.optionsZh||[])[i]??"",c=(t.optionsEn||[])[i]??l;b(e.id,t.key,{zh:l,en:c})},size:"sm",children:(a==="en"?t.optionsEn||[]:t.optionsZh||[]).map((n,i)=>s.jsx(M,{children:n},String(i)))}):s.jsx(D,{size:"sm",type:t.type==="number"?"number":"text",value:t.type==="number"?String(e.values[t.key]??""):j(e.values[t.key]),onChange:n=>{if(t.type==="number")b(e.id,t.key,Number(n.target.value));else{const i=e.values[t.key]&&typeof e.values[t.key]=="object"?e.values[t.key]:{zh:"",en:""};b(e.id,t.key,{...i,[a]:n.target.value})}}}):s.jsx("span",{className:"text-default-700",children:j(e.values[t.key])})},t.key)),s.jsx("td",{className:"px-4 py-2 text-right",children:o&&s.jsx(z,{size:"sm",variant:"flat",color:"danger",isIconOnly:!0,onPress:()=>Z(e.id),children:s.jsx(v,{icon:"lucide:trash"})})})]},e.id))})]})})})})};export{V as default};
